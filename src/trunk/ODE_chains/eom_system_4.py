import numpy as np

def eom_4(q, q_dot, q_ddot, u, params):
    g, m, l, Iz, c, d, gear = params
    eqs = np.array([
        Iz*(8*q_ddot[0] + 6*q_ddot[1] + 4*q_ddot[2] + 2*q_ddot[3])/2 + c*q[0] + d*q_dot[0] + g*m*(7*l*np.sin(q[0]) + 5*l*np.sin(q[0] + q[1]) + 3*l*np.sin(q[0] + q[1] + q[2]) + l*np.sin(q[0] + q[1] + q[2] + q[3])) - gear*u[0] - m*((-4*l*q_dot[0]*np.sin(q[0]) - 2*l*(q_dot[0] + q_dot[1])*np.sin(q[0] + q[1]))*(2*l*q_dot[0]*np.cos(q[0]) + l*(q_dot[0] + q_dot[1])*np.cos(q[0] + q[1])) + (2*l*q_dot[0]*np.sin(q[0]) + l*(q_dot[0] + q_dot[1])*np.sin(q[0] + q[1]))*(4*l*q_dot[0]*np.cos(q[0]) + 2*l*(q_dot[0] + q_dot[1])*np.cos(q[0] + q[1])) + (-4*l*q_dot[0]*np.sin(q[0]) - 4*l*(q_dot[0] + q_dot[1])*np.sin(q[0] + q[1]) - 2*l*(q_dot[0] + q_dot[1] + q_dot[2])*np.sin(q[0] + q[1] + q[2]))*(2*l*q_dot[0]*np.cos(q[0]) + 2*l*(q_dot[0] + q_dot[1])*np.cos(q[0] + q[1]) + l*(q_dot[0] + q_dot[1] + q_dot[2])*np.cos(q[0] + q[1] + q[2])) + (2*l*q_dot[0]*np.sin(q[0]) + 2*l*(q_dot[0] + q_dot[1])*np.sin(q[0] + q[1]) + l*(q_dot[0] + q_dot[1] + q_dot[2])*np.sin(q[0] + q[1] + q[2]))*(4*l*q_dot[0]*np.cos(q[0]) + 4*l*(q_dot[0] + q_dot[1])*np.cos(q[0] + q[1]) + 2*l*(q_dot[0] + q_dot[1] + q_dot[2])*np.cos(q[0] + q[1] + q[2])) + (-4*l*q_dot[0]*np.sin(q[0]) - 4*l*(q_dot[0] + q_dot[1])*np.sin(q[0] + q[1]) - 4*l*(q_dot[0] + q_dot[1] + q_dot[2])*np.sin(q[0] + q[1] + q[2]) - 2*l*(q_dot[0] + q_dot[1] + q_dot[2] + q_dot[3])*np.sin(q[0] + q[1] + q[2] + q[3]))*(2*l*q_dot[0]*np.cos(q[0]) + 2*l*(q_dot[0] + q_dot[1])*np.cos(q[0] + q[1]) + 2*l*(q_dot[0] + q_dot[1] + q_dot[2])*np.cos(q[0] + q[1] + q[2]) + l*(q_dot[0] + q_dot[1] + q_dot[2] + q_dot[3])*np.cos(q[0] + q[1] + q[2] + q[3])) + (2*l*q_dot[0]*np.sin(q[0]) + 2*l*(q_dot[0] + q_dot[1])*np.sin(q[0] + q[1]) + 2*l*(q_dot[0] + q_dot[1] + q_dot[2])*np.sin(q[0] + q[1] + q[2]) + l*(q_dot[0] + q_dot[1] + q_dot[2] + q_dot[3])*np.sin(q[0] + q[1] + q[2] + q[3]))*(4*l*q_dot[0]*np.cos(q[0]) + 4*l*(q_dot[0] + q_dot[1])*np.cos(q[0] + q[1]) + 4*l*(q_dot[0] + q_dot[1] + q_dot[2])*np.cos(q[0] + q[1] + q[2]) + 2*l*(q_dot[0] + q_dot[1] + q_dot[2] + q_dot[3])*np.cos(q[0] + q[1] + q[2] + q[3])))/2 + m*(2*l**2*q_ddot[0]*np.sin(q[0])**2 + 2*l**2*q_ddot[0]*np.cos(q[0])**2 + (4*l*np.sin(q[0]) + 2*l*np.sin(q[0] + q[1]))*(2*l*q_ddot[0]*np.sin(q[0]) + 2*l*q_dot[0]**2*np.cos(q[0]) + l*(q_ddot[0] + q_ddot[1])*np.sin(q[0] + q[1]) + l*(q_dot[0] + q_dot[1])**2*np.cos(q[0] + q[1])) + (4*l*np.cos(q[0]) + 2*l*np.cos(q[0] + q[1]))*(2*l*q_ddot[0]*np.cos(q[0]) - 2*l*q_dot[0]**2*np.sin(q[0]) + l*(q_ddot[0] + q_ddot[1])*np.cos(q[0] + q[1]) - l*(q_dot[0] + q_dot[1])**2*np.sin(q[0] + q[1])) + (-4*l*q_dot[0]*np.sin(q[0]) - 2*l*(q_dot[0] + q_dot[1])*np.sin(q[0] + q[1]))*(2*l*q_dot[0]*np.cos(q[0]) + l*(q_dot[0] + q_dot[1])*np.cos(q[0] + q[1])) + (2*l*q_dot[0]*np.sin(q[0]) + l*(q_dot[0] + q_dot[1])*np.sin(q[0] + q[1]))*(4*l*q_dot[0]*np.cos(q[0]) + 2*l*(q_dot[0] + q_dot[1])*np.cos(q[0] + q[1])) + (4*l*np.sin(q[0]) + 4*l*np.sin(q[0] + q[1]) + 2*l*np.sin(q[0] + q[1] + q[2]))*(2*l*q_ddot[0]*np.sin(q[0]) + 2*l*q_dot[0]**2*np.cos(q[0]) + 2*l*(q_ddot[0] + q_ddot[1])*np.sin(q[0] + q[1]) + 2*l*(q_dot[0] + q_dot[1])**2*np.cos(q[0] + q[1]) + l*(q_ddot[0] + q_ddot[1] + q_ddot[2])*np.sin(q[0] + q[1] + q[2]) + l*(q_dot[0] + q_dot[1] + q_dot[2])**2*np.cos(q[0] + q[1] + q[2])) + (4*l*np.cos(q[0]) + 4*l*np.cos(q[0] + q[1]) + 2*l*np.cos(q[0] + q[1] + q[2]))*(2*l*q_ddot[0]*np.cos(q[0]) - 2*l*q_dot[0]**2*np.sin(q[0]) + 2*l*(q_ddot[0] + q_ddot[1])*np.cos(q[0] + q[1]) - 2*l*(q_dot[0] + q_dot[1])**2*np.sin(q[0] + q[1]) + l*(q_ddot[0] + q_ddot[1] + q_ddot[2])*np.cos(q[0] + q[1] + q[2]) - l*(q_dot[0] + q_dot[1] + q_dot[2])**2*np.sin(q[0] + q[1] + q[2])) + (-4*l*q_dot[0]*np.sin(q[0]) - 4*l*(q_dot[0] + q_dot[1])*np.sin(q[0] + q[1]) - 2*l*(q_dot[0] + q_dot[1] + q_dot[2])*np.sin(q[0] + q[1] + q[2]))*(2*l*q_dot[0]*np.cos(q[0]) + 2*l*(q_dot[0] + q_dot[1])*np.cos(q[0] + q[1]) + l*(q_dot[0] + q_dot[1] + q_dot[2])*np.cos(q[0] + q[1] + q[2])) + (2*l*q_dot[0]*np.sin(q[0]) + 2*l*(q_dot[0] + q_dot[1])*np.sin(q[0] + q[1]) + l*(q_dot[0] + q_dot[1] + q_dot[2])*np.sin(q[0] + q[1] + q[2]))*(4*l*q_dot[0]*np.cos(q[0]) + 4*l*(q_dot[0] + q_dot[1])*np.cos(q[0] + q[1]) + 2*l*(q_dot[0] + q_dot[1] + q_dot[2])*np.cos(q[0] + q[1] + q[2])) + (4*l*np.sin(q[0]) + 4*l*np.sin(q[0] + q[1]) + 4*l*np.sin(q[0] + q[1] + q[2]) + 2*l*np.sin(q[0] + q[1] + q[2] + q[3]))*(2*l*q_ddot[0]*np.sin(q[0]) + 2*l*q_dot[0]**2*np.cos(q[0]) + 2*l*(q_ddot[0] + q_ddot[1])*np.sin(q[0] + q[1]) + 2*l*(q_dot[0] + q_dot[1])**2*np.cos(q[0] + q[1]) + 2*l*(q_ddot[0] + q_ddot[1] + q_ddot[2])*np.sin(q[0] + q[1] + q[2]) + 2*l*(q_dot[0] + q_dot[1] + q_dot[2])**2*np.cos(q[0] + q[1] + q[2]) + l*(q_ddot[0] + q_ddot[1] + q_ddot[2] + q_ddot[3])*np.sin(q[0] + q[1] + q[2] + q[3]) + l*(q_dot[0] + q_dot[1] + q_dot[2] + q_dot[3])**2*np.cos(q[0] + q[1] + q[2] + q[3])) + (4*l*np.cos(q[0]) + 4*l*np.cos(q[0] + q[1]) + 4*l*np.cos(q[0] + q[1] + q[2]) + 2*l*np.cos(q[0] + q[1] + q[2] + q[3]))*(2*l*q_ddot[0]*np.cos(q[0]) - 2*l*q_dot[0]**2*np.sin(q[0]) + 2*l*(q_ddot[0] + q_ddot[1])*np.cos(q[0] + q[1]) - 2*l*(q_dot[0] + q_dot[1])**2*np.sin(q[0] + q[1]) + 2*l*(q_ddot[0] + q_ddot[1] + q_ddot[2])*np.cos(q[0] + q[1] + q[2]) - 2*l*(q_dot[0] + q_dot[1] + q_dot[2])**2*np.sin(q[0] + q[1] + q[2]) + l*(q_ddot[0] + q_ddot[1] + q_ddot[2] + q_ddot[3])*np.cos(q[0] + q[1] + q[2] + q[3]) - l*(q_dot[0] + q_dot[1] + q_dot[2] + q_dot[3])**2*np.sin(q[0] + q[1] + q[2] + q[3])) + (-4*l*q_dot[0]*np.sin(q[0]) - 4*l*(q_dot[0] + q_dot[1])*np.sin(q[0] + q[1]) - 4*l*(q_dot[0] + q_dot[1] + q_dot[2])*np.sin(q[0] + q[1] + q[2]) - 2*l*(q_dot[0] + q_dot[1] + q_dot[2] + q_dot[3])*np.sin(q[0] + q[1] + q[2] + q[3]))*(2*l*q_dot[0]*np.cos(q[0]) + 2*l*(q_dot[0] + q_dot[1])*np.cos(q[0] + q[1]) + 2*l*(q_dot[0] + q_dot[1] + q_dot[2])*np.cos(q[0] + q[1] + q[2]) + l*(q_dot[0] + q_dot[1] + q_dot[2] + q_dot[3])*np.cos(q[0] + q[1] + q[2] + q[3])) + (2*l*q_dot[0]*np.sin(q[0]) + 2*l*(q_dot[0] + q_dot[1])*np.sin(q[0] + q[1]) + 2*l*(q_dot[0] + q_dot[1] + q_dot[2])*np.sin(q[0] + q[1] + q[2]) + l*(q_dot[0] + q_dot[1] + q_dot[2] + q_dot[3])*np.sin(q[0] + q[1] + q[2] + q[3]))*(4*l*q_dot[0]*np.cos(q[0]) + 4*l*(q_dot[0] + q_dot[1])*np.cos(q[0] + q[1]) + 4*l*(q_dot[0] + q_dot[1] + q_dot[2])*np.cos(q[0] + q[1] + q[2]) + 2*l*(q_dot[0] + q_dot[1] + q_dot[2] + q_dot[3])*np.cos(q[0] + q[1] + q[2] + q[3])))/2,
        Iz*(6*q_ddot[0] + 6*q_ddot[1] + 4*q_ddot[2] + 2*q_ddot[3])/2 + c*q[1] + d*q_dot[1] + g*m*(5*l*np.sin(q[0] + q[1]) + 3*l*np.sin(q[0] + q[1] + q[2]) + l*np.sin(q[0] + q[1] + q[2] + q[3])) - gear*u[1] - m*(2*l*(q_dot[0] + q_dot[1])*(2*l*q_dot[0]*np.sin(q[0]) + l*(q_dot[0] + q_dot[1])*np.sin(q[0] + q[1]))*np.cos(q[0] + q[1]) - 2*l*(q_dot[0] + q_dot[1])*(2*l*q_dot[0]*np.cos(q[0]) + l*(q_dot[0] + q_dot[1])*np.cos(q[0] + q[1]))*np.sin(q[0] + q[1]) + (-4*l*(q_dot[0] + q_dot[1])*np.sin(q[0] + q[1]) - 2*l*(q_dot[0] + q_dot[1] + q_dot[2])*np.sin(q[0] + q[1] + q[2]))*(2*l*q_dot[0]*np.cos(q[0]) + 2*l*(q_dot[0] + q_dot[1])*np.cos(q[0] + q[1]) + l*(q_dot[0] + q_dot[1] + q_dot[2])*np.cos(q[0] + q[1] + q[2])) + (4*l*(q_dot[0] + q_dot[1])*np.cos(q[0] + q[1]) + 2*l*(q_dot[0] + q_dot[1] + q_dot[2])*np.cos(q[0] + q[1] + q[2]))*(2*l*q_dot[0]*np.sin(q[0]) + 2*l*(q_dot[0] + q_dot[1])*np.sin(q[0] + q[1]) + l*(q_dot[0] + q_dot[1] + q_dot[2])*np.sin(q[0] + q[1] + q[2])) + (-4*l*(q_dot[0] + q_dot[1])*np.sin(q[0] + q[1]) - 4*l*(q_dot[0] + q_dot[1] + q_dot[2])*np.sin(q[0] + q[1] + q[2]) - 2*l*(q_dot[0] + q_dot[1] + q_dot[2] + q_dot[3])*np.sin(q[0] + q[1] + q[2] + q[3]))*(2*l*q_dot[0]*np.cos(q[0]) + 2*l*(q_dot[0] + q_dot[1])*np.cos(q[0] + q[1]) + 2*l*(q_dot[0] + q_dot[1] + q_dot[2])*np.cos(q[0] + q[1] + q[2]) + l*(q_dot[0] + q_dot[1] + q_dot[2] + q_dot[3])*np.cos(q[0] + q[1] + q[2] + q[3])) + (4*l*(q_dot[0] + q_dot[1])*np.cos(q[0] + q[1]) + 4*l*(q_dot[0] + q_dot[1] + q_dot[2])*np.cos(q[0] + q[1] + q[2]) + 2*l*(q_dot[0] + q_dot[1] + q_dot[2] + q_dot[3])*np.cos(q[0] + q[1] + q[2] + q[3]))*(2*l*q_dot[0]*np.sin(q[0]) + 2*l*(q_dot[0] + q_dot[1])*np.sin(q[0] + q[1]) + 2*l*(q_dot[0] + q_dot[1] + q_dot[2])*np.sin(q[0] + q[1] + q[2]) + l*(q_dot[0] + q_dot[1] + q_dot[2] + q_dot[3])*np.sin(q[0] + q[1] + q[2] + q[3])))/2 + m*(2*l*(q_dot[0] + q_dot[1])*(2*l*q_dot[0]*np.sin(q[0]) + l*(q_dot[0] + q_dot[1])*np.sin(q[0] + q[1]))*np.cos(q[0] + q[1]) - 2*l*(q_dot[0] + q_dot[1])*(2*l*q_dot[0]*np.cos(q[0]) + l*(q_dot[0] + q_dot[1])*np.cos(q[0] + q[1]))*np.sin(q[0] + q[1]) + 2*l*(2*l*q_ddot[0]*np.sin(q[0]) + 2*l*q_dot[0]**2*np.cos(q[0]) + l*(q_ddot[0] + q_ddot[1])*np.sin(q[0] + q[1]) + l*(q_dot[0] + q_dot[1])**2*np.cos(q[0] + q[1]))*np.sin(q[0] + q[1]) + 2*l*(2*l*q_ddot[0]*np.cos(q[0]) - 2*l*q_dot[0]**2*np.sin(q[0]) + l*(q_ddot[0] + q_ddot[1])*np.cos(q[0] + q[1]) - l*(q_dot[0] + q_dot[1])**2*np.sin(q[0] + q[1]))*np.cos(q[0] + q[1]) + (4*l*np.sin(q[0] + q[1]) + 2*l*np.sin(q[0] + q[1] + q[2]))*(2*l*q_ddot[0]*np.sin(q[0]) + 2*l*q_dot[0]**2*np.cos(q[0]) + 2*l*(q_ddot[0] + q_ddot[1])*np.sin(q[0] + q[1]) + 2*l*(q_dot[0] + q_dot[1])**2*np.cos(q[0] + q[1]) + l*(q_ddot[0] + q_ddot[1] + q_ddot[2])*np.sin(q[0] + q[1] + q[2]) + l*(q_dot[0] + q_dot[1] + q_dot[2])**2*np.cos(q[0] + q[1] + q[2])) + (4*l*np.cos(q[0] + q[1]) + 2*l*np.cos(q[0] + q[1] + q[2]))*(2*l*q_ddot[0]*np.cos(q[0]) - 2*l*q_dot[0]**2*np.sin(q[0]) + 2*l*(q_ddot[0] + q_ddot[1])*np.cos(q[0] + q[1]) - 2*l*(q_dot[0] + q_dot[1])**2*np.sin(q[0] + q[1]) + l*(q_ddot[0] + q_ddot[1] + q_ddot[2])*np.cos(q[0] + q[1] + q[2]) - l*(q_dot[0] + q_dot[1] + q_dot[2])**2*np.sin(q[0] + q[1] + q[2])) + (-4*l*(q_dot[0] + q_dot[1])*np.sin(q[0] + q[1]) - 2*l*(q_dot[0] + q_dot[1] + q_dot[2])*np.sin(q[0] + q[1] + q[2]))*(2*l*q_dot[0]*np.cos(q[0]) + 2*l*(q_dot[0] + q_dot[1])*np.cos(q[0] + q[1]) + l*(q_dot[0] + q_dot[1] + q_dot[2])*np.cos(q[0] + q[1] + q[2])) + (4*l*(q_dot[0] + q_dot[1])*np.cos(q[0] + q[1]) + 2*l*(q_dot[0] + q_dot[1] + q_dot[2])*np.cos(q[0] + q[1] + q[2]))*(2*l*q_dot[0]*np.sin(q[0]) + 2*l*(q_dot[0] + q_dot[1])*np.sin(q[0] + q[1]) + l*(q_dot[0] + q_dot[1] + q_dot[2])*np.sin(q[0] + q[1] + q[2])) + (4*l*np.sin(q[0] + q[1]) + 4*l*np.sin(q[0] + q[1] + q[2]) + 2*l*np.sin(q[0] + q[1] + q[2] + q[3]))*(2*l*q_ddot[0]*np.sin(q[0]) + 2*l*q_dot[0]**2*np.cos(q[0]) + 2*l*(q_ddot[0] + q_ddot[1])*np.sin(q[0] + q[1]) + 2*l*(q_dot[0] + q_dot[1])**2*np.cos(q[0] + q[1]) + 2*l*(q_ddot[0] + q_ddot[1] + q_ddot[2])*np.sin(q[0] + q[1] + q[2]) + 2*l*(q_dot[0] + q_dot[1] + q_dot[2])**2*np.cos(q[0] + q[1] + q[2]) + l*(q_ddot[0] + q_ddot[1] + q_ddot[2] + q_ddot[3])*np.sin(q[0] + q[1] + q[2] + q[3]) + l*(q_dot[0] + q_dot[1] + q_dot[2] + q_dot[3])**2*np.cos(q[0] + q[1] + q[2] + q[3])) + (4*l*np.cos(q[0] + q[1]) + 4*l*np.cos(q[0] + q[1] + q[2]) + 2*l*np.cos(q[0] + q[1] + q[2] + q[3]))*(2*l*q_ddot[0]*np.cos(q[0]) - 2*l*q_dot[0]**2*np.sin(q[0]) + 2*l*(q_ddot[0] + q_ddot[1])*np.cos(q[0] + q[1]) - 2*l*(q_dot[0] + q_dot[1])**2*np.sin(q[0] + q[1]) + 2*l*(q_ddot[0] + q_ddot[1] + q_ddot[2])*np.cos(q[0] + q[1] + q[2]) - 2*l*(q_dot[0] + q_dot[1] + q_dot[2])**2*np.sin(q[0] + q[1] + q[2]) + l*(q_ddot[0] + q_ddot[1] + q_ddot[2] + q_ddot[3])*np.cos(q[0] + q[1] + q[2] + q[3]) - l*(q_dot[0] + q_dot[1] + q_dot[2] + q_dot[3])**2*np.sin(q[0] + q[1] + q[2] + q[3])) + (-4*l*(q_dot[0] + q_dot[1])*np.sin(q[0] + q[1]) - 4*l*(q_dot[0] + q_dot[1] + q_dot[2])*np.sin(q[0] + q[1] + q[2]) - 2*l*(q_dot[0] + q_dot[1] + q_dot[2] + q_dot[3])*np.sin(q[0] + q[1] + q[2] + q[3]))*(2*l*q_dot[0]*np.cos(q[0]) + 2*l*(q_dot[0] + q_dot[1])*np.cos(q[0] + q[1]) + 2*l*(q_dot[0] + q_dot[1] + q_dot[2])*np.cos(q[0] + q[1] + q[2]) + l*(q_dot[0] + q_dot[1] + q_dot[2] + q_dot[3])*np.cos(q[0] + q[1] + q[2] + q[3])) + (4*l*(q_dot[0] + q_dot[1])*np.cos(q[0] + q[1]) + 4*l*(q_dot[0] + q_dot[1] + q_dot[2])*np.cos(q[0] + q[1] + q[2]) + 2*l*(q_dot[0] + q_dot[1] + q_dot[2] + q_dot[3])*np.cos(q[0] + q[1] + q[2] + q[3]))*(2*l*q_dot[0]*np.sin(q[0]) + 2*l*(q_dot[0] + q_dot[1])*np.sin(q[0] + q[1]) + 2*l*(q_dot[0] + q_dot[1] + q_dot[2])*np.sin(q[0] + q[1] + q[2]) + l*(q_dot[0] + q_dot[1] + q_dot[2] + q_dot[3])*np.sin(q[0] + q[1] + q[2] + q[3])))/2,
        Iz*(4*q_ddot[0] + 4*q_ddot[1] + 4*q_ddot[2] + 2*q_ddot[3])/2 + c*q[2] + d*q_dot[2] + g*m*(3*l*np.sin(q[0] + q[1] + q[2]) + l*np.sin(q[0] + q[1] + q[2] + q[3])) - gear*u[2] - m*(2*l*(q_dot[0] + q_dot[1] + q_dot[2])*(2*l*q_dot[0]*np.sin(q[0]) + 2*l*(q_dot[0] + q_dot[1])*np.sin(q[0] + q[1]) + l*(q_dot[0] + q_dot[1] + q_dot[2])*np.sin(q[0] + q[1] + q[2]))*np.cos(q[0] + q[1] + q[2]) - 2*l*(q_dot[0] + q_dot[1] + q_dot[2])*(2*l*q_dot[0]*np.cos(q[0]) + 2*l*(q_dot[0] + q_dot[1])*np.cos(q[0] + q[1]) + l*(q_dot[0] + q_dot[1] + q_dot[2])*np.cos(q[0] + q[1] + q[2]))*np.sin(q[0] + q[1] + q[2]) + (-4*l*(q_dot[0] + q_dot[1] + q_dot[2])*np.sin(q[0] + q[1] + q[2]) - 2*l*(q_dot[0] + q_dot[1] + q_dot[2] + q_dot[3])*np.sin(q[0] + q[1] + q[2] + q[3]))*(2*l*q_dot[0]*np.cos(q[0]) + 2*l*(q_dot[0] + q_dot[1])*np.cos(q[0] + q[1]) + 2*l*(q_dot[0] + q_dot[1] + q_dot[2])*np.cos(q[0] + q[1] + q[2]) + l*(q_dot[0] + q_dot[1] + q_dot[2] + q_dot[3])*np.cos(q[0] + q[1] + q[2] + q[3])) + (4*l*(q_dot[0] + q_dot[1] + q_dot[2])*np.cos(q[0] + q[1] + q[2]) + 2*l*(q_dot[0] + q_dot[1] + q_dot[2] + q_dot[3])*np.cos(q[0] + q[1] + q[2] + q[3]))*(2*l*q_dot[0]*np.sin(q[0]) + 2*l*(q_dot[0] + q_dot[1])*np.sin(q[0] + q[1]) + 2*l*(q_dot[0] + q_dot[1] + q_dot[2])*np.sin(q[0] + q[1] + q[2]) + l*(q_dot[0] + q_dot[1] + q_dot[2] + q_dot[3])*np.sin(q[0] + q[1] + q[2] + q[3])))/2 + m*(2*l*(q_dot[0] + q_dot[1] + q_dot[2])*(2*l*q_dot[0]*np.sin(q[0]) + 2*l*(q_dot[0] + q_dot[1])*np.sin(q[0] + q[1]) + l*(q_dot[0] + q_dot[1] + q_dot[2])*np.sin(q[0] + q[1] + q[2]))*np.cos(q[0] + q[1] + q[2]) - 2*l*(q_dot[0] + q_dot[1] + q_dot[2])*(2*l*q_dot[0]*np.cos(q[0]) + 2*l*(q_dot[0] + q_dot[1])*np.cos(q[0] + q[1]) + l*(q_dot[0] + q_dot[1] + q_dot[2])*np.cos(q[0] + q[1] + q[2]))*np.sin(q[0] + q[1] + q[2]) + 2*l*(2*l*q_ddot[0]*np.sin(q[0]) + 2*l*q_dot[0]**2*np.cos(q[0]) + 2*l*(q_ddot[0] + q_ddot[1])*np.sin(q[0] + q[1]) + 2*l*(q_dot[0] + q_dot[1])**2*np.cos(q[0] + q[1]) + l*(q_ddot[0] + q_ddot[1] + q_ddot[2])*np.sin(q[0] + q[1] + q[2]) + l*(q_dot[0] + q_dot[1] + q_dot[2])**2*np.cos(q[0] + q[1] + q[2]))*np.sin(q[0] + q[1] + q[2]) + 2*l*(2*l*q_ddot[0]*np.cos(q[0]) - 2*l*q_dot[0]**2*np.sin(q[0]) + 2*l*(q_ddot[0] + q_ddot[1])*np.cos(q[0] + q[1]) - 2*l*(q_dot[0] + q_dot[1])**2*np.sin(q[0] + q[1]) + l*(q_ddot[0] + q_ddot[1] + q_ddot[2])*np.cos(q[0] + q[1] + q[2]) - l*(q_dot[0] + q_dot[1] + q_dot[2])**2*np.sin(q[0] + q[1] + q[2]))*np.cos(q[0] + q[1] + q[2]) + (4*l*np.sin(q[0] + q[1] + q[2]) + 2*l*np.sin(q[0] + q[1] + q[2] + q[3]))*(2*l*q_ddot[0]*np.sin(q[0]) + 2*l*q_dot[0]**2*np.cos(q[0]) + 2*l*(q_ddot[0] + q_ddot[1])*np.sin(q[0] + q[1]) + 2*l*(q_dot[0] + q_dot[1])**2*np.cos(q[0] + q[1]) + 2*l*(q_ddot[0] + q_ddot[1] + q_ddot[2])*np.sin(q[0] + q[1] + q[2]) + 2*l*(q_dot[0] + q_dot[1] + q_dot[2])**2*np.cos(q[0] + q[1] + q[2]) + l*(q_ddot[0] + q_ddot[1] + q_ddot[2] + q_ddot[3])*np.sin(q[0] + q[1] + q[2] + q[3]) + l*(q_dot[0] + q_dot[1] + q_dot[2] + q_dot[3])**2*np.cos(q[0] + q[1] + q[2] + q[3])) + (4*l*np.cos(q[0] + q[1] + q[2]) + 2*l*np.cos(q[0] + q[1] + q[2] + q[3]))*(2*l*q_ddot[0]*np.cos(q[0]) - 2*l*q_dot[0]**2*np.sin(q[0]) + 2*l*(q_ddot[0] + q_ddot[1])*np.cos(q[0] + q[1]) - 2*l*(q_dot[0] + q_dot[1])**2*np.sin(q[0] + q[1]) + 2*l*(q_ddot[0] + q_ddot[1] + q_ddot[2])*np.cos(q[0] + q[1] + q[2]) - 2*l*(q_dot[0] + q_dot[1] + q_dot[2])**2*np.sin(q[0] + q[1] + q[2]) + l*(q_ddot[0] + q_ddot[1] + q_ddot[2] + q_ddot[3])*np.cos(q[0] + q[1] + q[2] + q[3]) - l*(q_dot[0] + q_dot[1] + q_dot[2] + q_dot[3])**2*np.sin(q[0] + q[1] + q[2] + q[3])) + (-4*l*(q_dot[0] + q_dot[1] + q_dot[2])*np.sin(q[0] + q[1] + q[2]) - 2*l*(q_dot[0] + q_dot[1] + q_dot[2] + q_dot[3])*np.sin(q[0] + q[1] + q[2] + q[3]))*(2*l*q_dot[0]*np.cos(q[0]) + 2*l*(q_dot[0] + q_dot[1])*np.cos(q[0] + q[1]) + 2*l*(q_dot[0] + q_dot[1] + q_dot[2])*np.cos(q[0] + q[1] + q[2]) + l*(q_dot[0] + q_dot[1] + q_dot[2] + q_dot[3])*np.cos(q[0] + q[1] + q[2] + q[3])) + (4*l*(q_dot[0] + q_dot[1] + q_dot[2])*np.cos(q[0] + q[1] + q[2]) + 2*l*(q_dot[0] + q_dot[1] + q_dot[2] + q_dot[3])*np.cos(q[0] + q[1] + q[2] + q[3]))*(2*l*q_dot[0]*np.sin(q[0]) + 2*l*(q_dot[0] + q_dot[1])*np.sin(q[0] + q[1]) + 2*l*(q_dot[0] + q_dot[1] + q_dot[2])*np.sin(q[0] + q[1] + q[2]) + l*(q_dot[0] + q_dot[1] + q_dot[2] + q_dot[3])*np.sin(q[0] + q[1] + q[2] + q[3])))/2,
        Iz*(2*q_ddot[0] + 2*q_ddot[1] + 2*q_ddot[2] + 2*q_ddot[3])/2 + c*q[3] + d*q_dot[3] + g*l*m*np.sin(q[0] + q[1] + q[2] + q[3]) - gear*u[3] - m*(2*l*(q_dot[0] + q_dot[1] + q_dot[2] + q_dot[3])*(2*l*q_dot[0]*np.sin(q[0]) + 2*l*(q_dot[0] + q_dot[1])*np.sin(q[0] + q[1]) + 2*l*(q_dot[0] + q_dot[1] + q_dot[2])*np.sin(q[0] + q[1] + q[2]) + l*(q_dot[0] + q_dot[1] + q_dot[2] + q_dot[3])*np.sin(q[0] + q[1] + q[2] + q[3]))*np.cos(q[0] + q[1] + q[2] + q[3]) - 2*l*(q_dot[0] + q_dot[1] + q_dot[2] + q_dot[3])*(2*l*q_dot[0]*np.cos(q[0]) + 2*l*(q_dot[0] + q_dot[1])*np.cos(q[0] + q[1]) + 2*l*(q_dot[0] + q_dot[1] + q_dot[2])*np.cos(q[0] + q[1] + q[2]) + l*(q_dot[0] + q_dot[1] + q_dot[2] + q_dot[3])*np.cos(q[0] + q[1] + q[2] + q[3]))*np.sin(q[0] + q[1] + q[2] + q[3]))/2 + m*(2*l*(q_dot[0] + q_dot[1] + q_dot[2] + q_dot[3])*(2*l*q_dot[0]*np.sin(q[0]) + 2*l*(q_dot[0] + q_dot[1])*np.sin(q[0] + q[1]) + 2*l*(q_dot[0] + q_dot[1] + q_dot[2])*np.sin(q[0] + q[1] + q[2]) + l*(q_dot[0] + q_dot[1] + q_dot[2] + q_dot[3])*np.sin(q[0] + q[1] + q[2] + q[3]))*np.cos(q[0] + q[1] + q[2] + q[3]) - 2*l*(q_dot[0] + q_dot[1] + q_dot[2] + q_dot[3])*(2*l*q_dot[0]*np.cos(q[0]) + 2*l*(q_dot[0] + q_dot[1])*np.cos(q[0] + q[1]) + 2*l*(q_dot[0] + q_dot[1] + q_dot[2])*np.cos(q[0] + q[1] + q[2]) + l*(q_dot[0] + q_dot[1] + q_dot[2] + q_dot[3])*np.cos(q[0] + q[1] + q[2] + q[3]))*np.sin(q[0] + q[1] + q[2] + q[3]) + 2*l*(2*l*q_ddot[0]*np.sin(q[0]) + 2*l*q_dot[0]**2*np.cos(q[0]) + 2*l*(q_ddot[0] + q_ddot[1])*np.sin(q[0] + q[1]) + 2*l*(q_dot[0] + q_dot[1])**2*np.cos(q[0] + q[1]) + 2*l*(q_ddot[0] + q_ddot[1] + q_ddot[2])*np.sin(q[0] + q[1] + q[2]) + 2*l*(q_dot[0] + q_dot[1] + q_dot[2])**2*np.cos(q[0] + q[1] + q[2]) + l*(q_ddot[0] + q_ddot[1] + q_ddot[2] + q_ddot[3])*np.sin(q[0] + q[1] + q[2] + q[3]) + l*(q_dot[0] + q_dot[1] + q_dot[2] + q_dot[3])**2*np.cos(q[0] + q[1] + q[2] + q[3]))*np.sin(q[0] + q[1] + q[2] + q[3]) + 2*l*(2*l*q_ddot[0]*np.cos(q[0]) - 2*l*q_dot[0]**2*np.sin(q[0]) + 2*l*(q_ddot[0] + q_ddot[1])*np.cos(q[0] + q[1]) - 2*l*(q_dot[0] + q_dot[1])**2*np.sin(q[0] + q[1]) + 2*l*(q_ddot[0] + q_ddot[1] + q_ddot[2])*np.cos(q[0] + q[1] + q[2]) - 2*l*(q_dot[0] + q_dot[1] + q_dot[2])**2*np.sin(q[0] + q[1] + q[2]) + l*(q_ddot[0] + q_ddot[1] + q_ddot[2] + q_ddot[3])*np.cos(q[0] + q[1] + q[2] + q[3]) - l*(q_dot[0] + q_dot[1] + q_dot[2] + q_dot[3])**2*np.sin(q[0] + q[1] + q[2] + q[3]))*np.cos(q[0] + q[1] + q[2] + q[3]))/2,
    ])
    return eqs
